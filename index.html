<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>葱妹和蒜姐</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <style type="text/css">
        @font-face {
            font-family: digit;
            src: url('digital-7_mono.ttf') format("truetype");
        }
        /* 添加这个样式来初始隐藏文字 */
        #code {
            display: none;
        }
    </style>
    <link href="css/default.css" type="text/css" rel="stylesheet">
    <script type="text/javascript" src="js/jquery.js"></script>
    <script type="text/javascript" src="js/garden.js"></script>
    <script type="text/javascript" src="js/functions.js"></script>
</head>

<body>
    <!-- 登录框 -->
    <div id="login-box">
        <div class="login-container">
            <h2>请输入密码</h2>
            <input type="password" id="password" placeholder="输入密码...">
            <button onclick="checkPassword()">进入</button>
            <p class="error-msg" id="error-msg">密码错误，请重试</p>
        </div>
    </div>

    <div id="musicControl">暂停音乐</div>

    <audio id="bgMusic" autoplay loop>
        <source src="./music/background.mp3" type="audio/mp3">
    </audio>

    <div id="mainDiv">
        <div id="content">
            <div id="code">
                傻瓜。<br />
                我爱你，我知道你肯定会很无奈的说我知道你爱我呢。<br />
                我想你，就像坐华师地铁线时总想遇见那个你相像的女孩。<br />
                想你的时候，就会特别嫉妒汉子。<br />
                嫉妒她和你一起上课吃饭逛街，我总是极度抱怨的说为什么不是我。<br />
                陪你跑步，陪你自习，和你睡上下铺的人为什么不是我呢。<br />
                也就这时候我才发现我是有多小心眼。<br />
                还记得我们说好的两居室吗。<br />
                一卧室一书房，我们可以在客厅跳舞弹琴。<br />
                房子不要很大，只要里面有我和你。<br />
                对了，你还说要放加湿器，你怕我流鼻血。<br />
                还记得有一天我对你说了很多遍想你吗。想你，只剩下这句话的时候。<br />
                你不知道我的生活会有多空虚，<br />
                只因其他填充不了它的空缺。<br />
                还记得我说过不要和五六个人做的伴娘吗。<br />
                因为我不是唯一的伴娘，我会生气的。<br />
                还有，我怕我舍不得你出嫁，抢婚了怎么办。<br />
                嘿嘿，有木有好傻。但我就是这么想的。<br />
                我想看到你幸福，但我不想看着你跟别人走。<br />
                小傻瓜，我想你。<br />
                累了，难过了不许哭鼻子。<br />
                你想去月球想去火星我都会陪着你。<br />
                只要你快乐。<br />
                小傻瓜，我爱你。<br />
                我总会习惯逛商场就会想要给你买衣服买干豆片买很多你爱吃的零食。<br />
                一盒干豆片你却能吃上一个学期。<br />
                可听到你说因减肥不吃晚饭的时候你不知道我有多担心你。<br />
                傻瓜，你多肥多"丑"我都会爱你。<br />
                只要你健康。<br />
                争吵也好，离别也好，我都爱你。
            </div>
            <div id="loveHeart">
                <canvas id="garden"></canvas>
                <div id="words">
                    <div id="messages">
                        <font color="#66B032">葱妹</font>和<font color="#D8BFD8">蒜姐</font>在一起<span class="STYLE1">已经....</span>
                        <div id="elapseClock"></div>
                    </div>
                    <div id="loveu">
                        Since 2008-12-13.<br/>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        var audio = document.getElementById('bgMusic');
        var musicControl = document.getElementById('musicControl');
        var isPlaying = false;
        var offsetX = $("#loveHeart").width() / 2;
        var offsetY = $("#loveHeart").height() / 2 - 55;
        var together = new Date();
        together.setFullYear(2008, 12, 13);
        together.setHours(0);
        together.setMinutes(0);
        together.setSeconds(0);
        together.setMilliseconds(0);

        // 密码验证函数
        function checkPassword() {
            var password = document.getElementById('password').value;
            if (password === "20081213") {
                // 隐藏登录框
                document.getElementById('login-box').style.display = 'none';
                // 显示音乐控制按钮
                document.getElementById('musicControl').style.display = 'block';
                // 开始播放音乐
                startMusic();
                // 初始化动画
                startAnimation();
            } else {
                document.getElementById('error-msg').style.display = 'block';
            }
        }

        // 音乐控制函数
        function startMusic() {
            audio.play().then(function() {
                isPlaying = true;
                updateButtonText();
            }).catch(function(error) {
                console.log("播放失败:", error);
            });
        }

        function updateButtonText() {
            musicControl.textContent = isPlaying ? '暂停音乐' : '播放音乐';
        }

        function togglePlay() {
            if (isPlaying) {
                audio.pause();
            } else {
                audio.play();
            }
            isPlaying = !isPlaying;
            updateButtonText();
        }

        // 音乐控制事件监听
        musicControl.addEventListener('click', togglePlay);

        // 启动动画和计时器
        function startAnimation() {
            if (!document.createElement('canvas').getContext) {
                var msg = document.createElement("div");
                msg.id = "errorMsg";
                msg.innerHTML = "Your browser doesn't support HTML5!<br/>Recommend use Chrome 14+/IE 9+/Firefox 7+/Safari 4+"; 
                document.body.appendChild(msg);
                $("#code").css("display", "none")
                $("#copyright").css("position", "absolute");
                $("#copyright").css("bottom", "10px");
                document.execCommand("stop");
            } else {
                // 启动心形动画
                startHeartAnimation();
                
                // 启动并持续更新时间
                timeElapse(together);
                setInterval(function () {
                    timeElapse(together);
                }, 500);
                
                // 调整代码位置
                adjustCodePosition();
                
                // 显示代码区域
                $("#code").css("display", "block");
            }
        }

        // 监听回车键
        document.getElementById('password').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                checkPassword();
            }
        });
    </script>
</body>
</html>